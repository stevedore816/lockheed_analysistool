package vulnerabilityDetector;

import java.util.ArrayList;

import codeInterpration.CodeInterpreter;
/*
 * This class is where the general list of attackVectors will be stored 
 */
public class cyberAttacks {
	//vector value that will be referenced on a global reference using getList()
	private ArrayList<attackVector> vector = new ArrayList<attackVector>();
	
	/*adds a value to the global reference vector
	 * @param attack is the attackvector to be added from the list
	 */
	public  void add (attackVector attack) {
		vector.add(attack); 
	}
	/*adds a value to the global reference vector
	 * @param attack is the attackvector to be removed from the list
	 */
	public void remove (attackVector attack) {
		vector.remove(attack); 
	}
	
	
	public void removeall() {
		vector.removeAll(vector); 
	}
	/*
	 * @return returns the list of attacks that the code has
	 */
	public ArrayList<attackVector> getList() {
		return vector; 
	}
	/*
	 * @param type the type that is going to be found in this list
	 * @return returns an array of vectors that are all the same cyber attack
	 */
	public ArrayList<attackVector> sortByType(Type type) {
		ArrayList<attackVector> newVector = new ArrayList<attackVector>(); 
		for(attackVector attack : vector) {
			if(attack.getType() == type) {
				newVector.add(attack); 
			}
		}
		
		return newVector;
	}
	
	public String getString() {
	String	str = "";
	
	for (attackVector attack : vector) {
		str += "\nvulnerable line: " + attack.getvCode() + "\nType line is vulnerable to: " +  attack.getType().toString() 
				+ "\nhelpful resource to learn about attack type: " + attack.getResource() + "\n"; 
	}
	
		return str;
	}
	public void pushDatabase(CodeInterpreter code) {
		for (attackVector attack : vector) {
			attack.pushToDataBase(code);
		}
	}
}
