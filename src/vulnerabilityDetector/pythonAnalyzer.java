package vulnerabilityDetector;

import java.util.ArrayList;

import codeInterpration.CodeInterpreter;

public class pythonAnalyzer extends Analyzer {

	/* This method should work by looking at inputs of python code specifically if the java code is in SQL (Django for Python)
	 * Use regex expressions in order to find blocks of information and data for input values and find out if these
	 * instances make the system vulnerable or not
	 * 
	 * .execute[(]( |)('|\")SELECT.+FROM.+('|\").*..*( |)[)]( |\n)
	 */
	public void checkInputValidation() {
		
		ArrayList<String> queries = CodeInterpreter.searchCode(code, ".execute[(]( |)('|\")SELECT.+FROM.+('|\").*..*( |)[)]( |\n)");
		for (String searches : queries) {
			if (CodeInterpreter.searchCode(searches, "('|\")( |)%(| )([a-zA-Z0-9]+)[)]").size() > 0) {
				cyberAttacks.add(new attackVector(searches, Type.INPUTVALIDATION));
			}
		}  
		super.checkInputValidation();
		
	}
	
	public boolean hasSanitizeMethod() {
		return false;
	}

}
